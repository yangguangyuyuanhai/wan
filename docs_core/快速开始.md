# ğŸš€ å¿«é€Ÿå¼€å§‹æŒ‡å—

## ğŸ“‹ ç›®å½•
1. [ç¯å¢ƒå‡†å¤‡](#ç¯å¢ƒå‡†å¤‡)
2. [5åˆ†é’Ÿå¿«é€Ÿä½“éªŒ](#5åˆ†é’Ÿå¿«é€Ÿä½“éªŒ)
3. [å¸¸ç”¨åœºæ™¯](#å¸¸ç”¨åœºæ™¯)
4. [æ•…éšœæ’æŸ¥](#æ•…éšœæ’æŸ¥)

---

## ğŸ”§ ç¯å¢ƒå‡†å¤‡

### 1. å®‰è£…Pythonä¾èµ–

```bash
# åŸºç¡€ä¾èµ–ï¼ˆå¿…éœ€ï¼‰
pip install numpy opencv-python

# YOLOæ£€æµ‹ï¼ˆå¯é€‰ï¼Œå¦‚æœéœ€è¦ç›®æ ‡æ£€æµ‹ï¼‰
pip install ultralytics

# æˆ–è€…ä½¿ç”¨requirements.txt
pip install -r requirements.txt
```

### 2. è®¾ç½®ç¯å¢ƒå˜é‡ï¼ˆWindowsï¼‰

```cmd
# è®¾ç½®SDKè·¯å¾„
setx MVCAM_COMMON_RUNENV "F:\MVS"
```

### 3. å‡†å¤‡YOLOæ¨¡å‹ï¼ˆå¯é€‰ï¼‰

```bash
# åˆ›å»ºæ¨¡å‹ç›®å½•
mkdir models

# ä¸‹è½½YOLOv8æ¨¡å‹ï¼ˆè‡ªåŠ¨ä¸‹è½½ï¼‰
# æˆ–æ‰‹åŠ¨ä¸‹è½½æ”¾åˆ° models/ ç›®å½•
```

---

## âš¡ 5åˆ†é’Ÿå¿«é€Ÿä½“éªŒ

### ç¬¬1æ­¥ï¼šæ£€æŸ¥æ–‡ä»¶ç»“æ„

ç¡®ä¿ä½ æœ‰ä»¥ä¸‹æ–‡ä»¶ï¼š

```
F:\MVS\
â”œâ”€â”€ main.py                    # ä¸»ç¨‹åº âœ“
â”œâ”€â”€ scheduler.py               # è°ƒåº¦å™¨ âœ“
â”œâ”€â”€ pipeline_core.py           # ç®¡é“æ ¸å¿ƒ âœ“
â”œâ”€â”€ pipeline_config.py         # é…ç½® âœ“
â”œâ”€â”€ logger_config.py           # æ—¥å¿— âœ“
â”œâ”€â”€ services/                  # æœåŠ¡ç›®å½• âœ“
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ camera_service.py
â”‚   â”œâ”€â”€ preprocess_service.py
â”‚   â”œâ”€â”€ yolo_service.py
â”‚   â”œâ”€â”€ opencv_service.py
â”‚   â”œâ”€â”€ display_service.py
â”‚   â””â”€â”€ storage_service.py
â””â”€â”€ logs/                      # æ—¥å¿—ç›®å½•ï¼ˆè‡ªåŠ¨åˆ›å»ºï¼‰
```

### ç¬¬2æ­¥ï¼šè¿è¡Œç³»ç»Ÿ

```bash
# è¿›å…¥ç›®å½•
cd F:\MVS

# è¿è¡Œï¼ˆå¼€å‘æ¨¡å¼ï¼‰
python main.py
```

### ç¬¬3æ­¥ï¼šè§‚å¯Ÿè¾“å‡º

ä½ ä¼šçœ‹åˆ°ï¼š

```
==================================================
å·¥ä¸šè§†è§‰ç³»ç»Ÿ
==================================================
[INFO] åŠ è½½é…ç½®: development æ¨¡å¼
[INFO] é…ç½®åŠ è½½å®Œæˆ
[INFO] åˆå§‹åŒ–ç³»ç»Ÿ...
[INFO] å¼€å§‹åˆå§‹åŒ–ç®¡é“ç³»ç»Ÿ...

ã€å¯ç”¨çš„æœåŠ¡ã€‘
  ç›¸æœºé‡‡é›†: âœ“ å¯ç”¨
  å›¾åƒé¢„å¤„ç†: âœ“ å¯ç”¨
  YOLOæ£€æµ‹: âœ“ å¯ç”¨
  OpenCVå¤„ç†: âœ“ å¯ç”¨
  å›¾åƒæ˜¾ç¤º: âœ“ å¯ç”¨
  æ•°æ®å­˜å‚¨: âœ— ç¦ç”¨

[INFO] æ‰¾åˆ° 1 ä¸ªè®¾å¤‡
[INFO] [0] GigE: MV-CA016-10GC (IP: 192.168.1.100)
[INFO] è®¾å¤‡æ‰“å¼€æˆåŠŸ
[INFO] å¼€å§‹é‡‡é›†
[INFO] ç®¡é“ç³»ç»Ÿå¯åŠ¨æˆåŠŸ
[INFO] æŒ‰ Ctrl+C åœæ­¢ç³»ç»Ÿ
```

### ç¬¬4æ­¥ï¼šæŸ¥çœ‹å®æ—¶æ˜¾ç¤º

ä¼šå¼¹å‡ºä¸€ä¸ªçª—å£æ˜¾ç¤ºï¼š
- å®æ—¶å›¾åƒ
- æ£€æµ‹æ¡†ï¼ˆå¦‚æœæœ‰ç›®æ ‡ï¼‰
- FPSä¿¡æ¯
- å¸§å·

### ç¬¬5æ­¥ï¼šåœæ­¢ç³»ç»Ÿ

æŒ‰ `Ctrl+C` æˆ–åœ¨æ˜¾ç¤ºçª—å£æŒ‰ `q` é”®

---

## ğŸ¯ å¸¸ç”¨åœºæ™¯

### åœºæ™¯1: åªé‡‡é›†å›¾åƒï¼Œä¸åšæ£€æµ‹

```bash
# ç¼–è¾‘ pipeline_config.py
# æ‰¾åˆ° YOLOServiceConfigï¼Œè®¾ç½®ï¼š
enabled = False

# æˆ–è€…ç›´æ¥ç¦ç”¨YOLOæœåŠ¡
python main.py
# ç„¶ååœ¨ä»£ç ä¸­æ³¨é‡Šæ‰YOLOç›¸å…³éƒ¨åˆ†
```

### åœºæ™¯2: è°ƒæ•´ç›¸æœºå‚æ•°

```bash
# æ–¹æ³•1ï¼šå‘½ä»¤è¡Œå‚æ•°
python main.py --exposure 15000 --gain 12.0 --frame-rate 25

# æ–¹æ³•2ï¼šä¿®æ”¹é…ç½®æ–‡ä»¶
# ç¼–è¾‘ pipeline_config.py
class CameraServiceConfig:
    exposure_time = 15000
    gain = 12.0
    frame_rate = 25.0
```

### åœºæ™¯3: ä¿å­˜æ£€æµ‹åˆ°çš„å›¾åƒ

```bash
# å¯ç”¨å­˜å‚¨æœåŠ¡
python main.py --save-images

# å›¾åƒä¼šä¿å­˜åˆ° ./output/images/ ç›®å½•
```

### åœºæ™¯4: ç”Ÿäº§ç¯å¢ƒè¿è¡Œï¼ˆæ— æ˜¾ç¤ºï¼‰

```bash
# ç”Ÿäº§æ¨¡å¼ + ç¦ç”¨æ˜¾ç¤º + ä¿å­˜å›¾åƒ
python main.py --mode production --no-display --save-images

# åå°è¿è¡Œï¼ˆLinuxï¼‰
nohup python main.py --mode production --no-display --save-images > output.log 2>&1 &
```

### åœºæ™¯5: è°ƒè¯•æ¨¡å¼ï¼ˆé‡‡é›†100å¸§ååœæ­¢ï¼‰

```bash
# ä½¿ç”¨è°ƒè¯•æ¨¡å¼
python main.py --mode debug

# æˆ–ä¿®æ”¹é…ç½®
# pipeline_config.py
class CameraServiceConfig:
    max_frames = 100
```

### åœºæ™¯6: ä½¿ç”¨è‡ªå·±çš„YOLOæ¨¡å‹

```bash
# æ–¹æ³•1ï¼šå‘½ä»¤è¡Œ
python main.py --yolo-model ./models/my_model.pt --confidence 0.7

# æ–¹æ³•2ï¼šä¿®æ”¹é…ç½®
# pipeline_config.py
class YOLOServiceConfig:
    model_path = "./models/my_model.pt"
    confidence_threshold = 0.7
```

---

## ğŸ” æ•…éšœæ’æŸ¥

### é—®é¢˜1: æ‰¾ä¸åˆ°ç›¸æœº

**é”™è¯¯ä¿¡æ¯ï¼š**
```
[ERROR] æœªæ‰¾åˆ°ç›¸æœºè®¾å¤‡
```

**è§£å†³æ–¹æ¡ˆï¼š**
1. æ£€æŸ¥ç›¸æœºæ˜¯å¦è¿æ¥
2. æ£€æŸ¥é©±åŠ¨æ˜¯å¦å®‰è£…
   ```bash
   # è¿è¡Œé©±åŠ¨å®‰è£…å·¥å…·
   F:\MVS\Applications\Win64\Driver_Installation_Tool.exe
   ```
3. æ£€æŸ¥ç¯å¢ƒå˜é‡
   ```cmd
   echo %MVCAM_COMMON_RUNENV%
   # åº”è¯¥è¾“å‡º: F:\MVS
   ```

---

### é—®é¢˜2: YOLOæ¨¡å‹åŠ è½½å¤±è´¥

**é”™è¯¯ä¿¡æ¯ï¼š**
```
[ERROR] åŠ è½½æ¨¡å‹å¤±è´¥
```

**è§£å†³æ–¹æ¡ˆï¼š**
1. æ£€æŸ¥æ¨¡å‹æ–‡ä»¶æ˜¯å¦å­˜åœ¨
   ```bash
   dir models\yolov8n.pt
   ```
2. å®‰è£…ultralytics
   ```bash
   pip install ultralytics
   ```
3. å¦‚æœä¸éœ€è¦YOLOï¼Œç¦ç”¨å®ƒ
   ```bash
   # ç¼–è¾‘ pipeline_config.py
   class YOLOServiceConfig:
       enabled = False
   ```

---

### é—®é¢˜3: æ˜¾ç¤ºçª—å£æ— å“åº”

**é”™è¯¯ä¿¡æ¯ï¼š**
```
çª—å£å¡æ­»æˆ–æ— æ³•å…³é—­
```

**è§£å†³æ–¹æ¡ˆï¼š**
1. æŒ‰ `q` é”®æˆ– `ESC` é”®é€€å‡º
2. å¦‚æœè¿˜æ˜¯æ— å“åº”ï¼ŒæŒ‰ `Ctrl+C`
3. ç¦ç”¨æ˜¾ç¤º
   ```bash
   python main.py --no-display
   ```

---

### é—®é¢˜4: å¸§ç‡å¤ªä½

**ç°è±¡ï¼š**
```
FPS: 5.2
```

**è§£å†³æ–¹æ¡ˆï¼š**
1. ç¦ç”¨YOLOæ£€æµ‹
   ```python
   # pipeline_config.py
   yolo_service.enabled = False
   ```
2. å‡å°å›¾åƒåˆ†è¾¨ç‡
   ```python
   # pipeline_config.py
   preprocess_service.resize_enabled = True
   preprocess_service.resize_width = 640
   preprocess_service.resize_height = 480
   ```
3. ä½¿ç”¨æ›´å¿«çš„YOLOæ¨¡å‹
   ```bash
   python main.py --yolo-model ./models/yolov8n.pt  # n=nanoï¼Œæœ€å¿«
   ```

---

### é—®é¢˜5: å†…å­˜å ç”¨è¿‡é«˜

**è§£å†³æ–¹æ¡ˆï¼š**
1. å‡å°ç¼“å†²åŒºå¤§å°
   ```python
   # pipeline_config.py
   camera_service.buffer_size = 5
   pipeline_buffer_size = 5
   ```
2. ç¦ç”¨å›¾åƒä¿å­˜
   ```python
   storage_service.enabled = False
   ```

---

## ğŸ“Š æŸ¥çœ‹æ—¥å¿—

### å®æ—¶æŸ¥çœ‹æ—¥å¿—

```bash
# Windows
type logs\CameraApp_detail.log

# Linux
tail -f logs/CameraApp_detail.log
```

### æŸ¥æ‰¾é”™è¯¯

```bash
# Windows
findstr "ERROR" logs\CameraApp_error.log

# Linux
grep "ERROR" logs/CameraApp_error.log
```

---

## ğŸ“ ä¸‹ä¸€æ­¥

### å­¦ä¹ æ›´å¤š

1. **ç³»ç»Ÿæ¶æ„** - é˜…è¯» `ç³»ç»Ÿæ¶æ„è¯´æ˜.md`
2. **é…ç½®è¯¦è§£** - æŸ¥çœ‹ `pipeline_config.py`
3. **æ·»åŠ åŠŸèƒ½** - å‚è€ƒå¼€å‘æŒ‡å—

### è‡ªå®šä¹‰å¼€å‘

1. **æ·»åŠ æ–°çš„è¿‡æ»¤å™¨** - å‚è€ƒ `services/` ç›®å½•ä¸‹çš„ç¤ºä¾‹
2. **ä¿®æ”¹å¤„ç†é€»è¾‘** - ç¼–è¾‘å¯¹åº”çš„æœåŠ¡æ–‡ä»¶
3. **è°ƒæ•´é…ç½®** - ä¿®æ”¹ `pipeline_config.py`

---

## ğŸ’¡ å°æŠ€å·§

### 1. å¿«é€Ÿæµ‹è¯•

```bash
# è°ƒè¯•æ¨¡å¼ï¼Œåªé‡‡é›†10å¸§
python main.py --mode debug
# ç„¶åä¿®æ”¹ pipeline_config.py ä¸­çš„ max_frames = 10
```

### 2. æ€§èƒ½æµ‹è¯•

```bash
# ç¦ç”¨æ˜¾ç¤ºå’Œå­˜å‚¨ï¼Œæµ‹è¯•çº¯å¤„ç†æ€§èƒ½
python main.py --no-display
```

### 3. æŸ¥çœ‹å¸®åŠ©

```bash
python main.py --help
```

### 4. æŸ¥çœ‹é…ç½®

```bash
# è¿è¡Œåä¼šæ‰“å°å½“å‰é…ç½®
python main.py
# æŸ¥çœ‹è¾“å‡ºçš„é…ç½®ä¿¡æ¯
```

---

## ğŸ“ è·å–å¸®åŠ©

### æŸ¥çœ‹æ–‡æ¡£

- `ç³»ç»Ÿæ¶æ„è¯´æ˜.md` - å®Œæ•´æ¶æ„æ–‡æ¡£
- `pipeline_config.py` - é…ç½®è¯´æ˜
- `logger_config.py` - æ—¥å¿—è¯´æ˜

### æŸ¥çœ‹æ—¥å¿—

```bash
# è¯¦ç»†æ—¥å¿—
type logs\CameraApp_detail.log

# é”™è¯¯æ—¥å¿—
type logs\CameraApp_error.log
```

### è°ƒè¯•æ¨¡å¼

```bash
# å¯ç”¨æœ€è¯¦ç»†çš„æ—¥å¿—
python main.py --mode debug
```

---

## âœ… æ£€æŸ¥æ¸…å•

è¿è¡Œå‰æ£€æŸ¥ï¼š

- [ ] Python 3.6+ å·²å®‰è£…
- [ ] ä¾èµ–åŒ…å·²å®‰è£…ï¼ˆnumpy, opencv-pythonï¼‰
- [ ] ç›¸æœºå·²è¿æ¥
- [ ] é©±åŠ¨å·²å®‰è£…
- [ ] ç¯å¢ƒå˜é‡å·²è®¾ç½®
- [ ] æ–‡ä»¶ç»“æ„å®Œæ•´

---

**ç°åœ¨å¼€å§‹ä½ çš„è§†è§‰ä¹‹æ—…å§ï¼** ğŸ‰

```bash
python main.py
```
